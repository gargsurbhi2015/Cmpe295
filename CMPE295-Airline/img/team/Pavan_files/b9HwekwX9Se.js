if (self.CavalryLogger) { CavalryLogger.start_js(["iq8Gi"]); }

__d('ReactComposerMediaFilePickerController.react',['cx','ReactComposerAttachmentActions','ReactComposerAttachmentType','ReactComposerContextMixin','ComposerTargetData','Bootloader','DOM','DOMContainer.react','Event','FileInput.react','FileInput','ReactComponentWithPureRenderMixin','React','ReactDOM','SubscriptionsHandler','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'ReactComposerMediaFilePickerController',_prefillFileInput:null,_subscriptions:null,mixins:[c('ReactComposerContextMixin'),c('ReactComponentWithPureRenderMixin')],propTypes:{disableFaceRecognition:i.bool.isRequired,mediaAcceptParam:i.shape({photos:i.string,both:i.string}).isRequired,photoLimit:i.number.isRequired,targetData:i.instanceOf(c('ComposerTargetData')).isRequired,mediaConfig:i.object.isRequired,containerClassName:i.string,fileInputDOM:i.any,onClick:i.func},getDefaultProps:function(){return {disableFaceRecognition:false};},componentDidMount:function(){if(this.props.fileInputDOM){var k=c('DOM').find(c('ReactDOM').findDOMNode(this),'input[type="file"]');if(k.files&&k.files.length>0)this._uploadExistingFiles(k.files);this._prefillFileInput=new (c('FileInput'))(c('ReactDOM').findDOMNode(this.refs.prefillContainer),c('ReactDOM').findDOMNode(this.refs.prefillSelector),k);this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(c('Event').listen(k,'change',this._onFilesSelected));}},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},render:function(){var k=this.props.fileInputDOM;if(k){var l=c('React').cloneElement(c('React').Children.only(this.props.children),{ref:'prefillSelector'});return (c('React').createElement('span',{className:c('joinClasses')(this.props.containerClassName,"_m"),onClick:this._onFileInputClick,ref:'prefillContainer'},l,c('React').createElement(c('DOMContainer.react'),null,k)));}return (c('React').createElement(c('FileInput.react'),{accept:this.props.mediaAcceptParam.both,containerClassName:this.props.containerClassName,multiple:this.props.targetData.targetSupportsMultiplePhotos,name:'composer_photo[]',display:'inline',onChange:this._onFilesSelected,onClick:this._onFileInputClick,ref:'fileInput',role:'button',tabIndex:'0'},this.props.children));},_uploadExistingFiles:function(k){c('Bootloader').loadModules(["ReactComposerMediaUtils","ReactComposerPhotoUploader"],function(l,m){return (l.uploadPhotosOrVideo(this.context.composerID,Array.prototype.slice.call(k),new m(this.context,this.props.photoLimit,{disableFaceRecognition:this.props.disableFaceRecognition}),this.props.targetData.targetSupportsMultiplePhotos,this.props.targetData.targetSupportsMultiMedia));}.bind(this),'ReactComposerMediaFilePickerController.react');},_onFileInputClick:function(){c('ReactComposerAttachmentActions').initializeAttachment(this.context.composerID,c('ReactComposerAttachmentType').MEDIA);c('Bootloader').loadModules(["ReactComposerLoggingActions"],function(k){k.mediaUploadInputClicked(this.context.composerID);}.bind(this),'ReactComposerMediaFilePickerController.react');this.props.onClick&&this.props.onClick();},_onFilesSelected:function(event){event.persist&&event.persist();var k=this._prefillFileInput||this.refs.fileInput.getFileInput();c('Bootloader').loadModules(["ReactComposerPhotoUploader","ReactComposerMediaUtils"],function(l,m){var n=m.handleSpecialMediaUpload(event,k,this.props.mediaConfig,this.context);if(!n){var o=new l(this.context,this.props.photoLimit,{disableFaceRecognition:this.props.disableFaceRecognition});c('ReactComposerAttachmentActions').selectAttachment(this.context.composerID,c('ReactComposerAttachmentType').MEDIA,true);m.uploadPhotosOrVideoFromTarget(this.context.composerID,event.target,o,this.props.targetData.targetSupportsMultiplePhotos,this.props.targetData.targetSupportsMultiMedia);}m.clearInput(k);}.bind(this),'ReactComposerMediaFilePickerController.react');}});f.exports=j;},null);
__d('ReactComposerPhotoTaggerButton.react',['cx','fbt','ReactComposerContextMixin','ReactComposerMediaUtils','ComposerTargetData','FileInput.react','ReactComponentWithPureRenderMixin','React','TooltipLink.react','VideoUploadConfig','XUIAmbientNUX.react','joinClasses'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('React').createClass({displayName:'ReactComposerPhotoTaggerButton',mixins:[c('ReactComposerContextMixin'),c('ReactComponentWithPureRenderMixin')],propTypes:{photoLimit:j.number.isRequired,hasData:j.bool,selected:j.bool,multimediaNuxShown:j.bool,onNUXCloseButtonClick:j.func},getDefaultProps:function(){return {hasData:false,selected:false};},render:function(){var l="_3xem"+(this.props.selected?' '+"_50hx":''),m=c('joinClasses')((!this.context.gks.has_facelift_glyphs?"_3xen":'')+(this.context.gks.has_facelift_glyphs?' '+"_2vwi":'')+(!this.context.gks.has_facelift_glyphs?' '+"_6xd":'')+(this.context.gks.has_facelift_glyphs?' '+"_lnh":'')+(this.props.hasData?' '+"_6xe":''),this.props.className),n=this._renderMultimediaAttachmentsNux(),o,p=this.props.photoLimit>1,q=c('VideoUploadConfig').allowMultimedia&&this.props.targetData.targetSupportsMultiMedia;if(p){if(q){o=i._("Add photos and videos to your post");}else o=i._("Add photos or a video to your post");}else o=i._("Add a photo or a video to your post");return (c('React').createElement(c('TooltipLink.react'),{onClick:this._onSelect,tooltip:o},c('React').createElement('span',{className:"accessible_elem"},this.props.photoLimit>1?i._("Add photos"):i._("Add photo")),c('React').createElement('div',{className:m}),n));},_renderMultimediaAttachmentsNux:function(){return (c('React').createElement(c('XUIAmbientNUX.react'),{position:'below',width:'custom',contextRef:function(){return this.refs.fileInput;}.bind(this),customwidth:400,shown:this.props.multimediaNuxShown,onCloseButtonClick:this.props.onNUXCloseButtonClick},i._("You can now add photos and videos to the same post.")));}});f.exports=k;},null);
__d('ReactComposerPhotoTaggerButtonWithOptions.react',['cx','fbt','ReactComposerAttachmentActions','ReactComposerAttachmentType','ReactComposerContextMixin','ReactComposerMediaFilePickerController.react','ReactComposerMediaUtils','ReactComposerPhotoCarouselActions','ReactComposerPhotoTaggerButton.react','ReactComposerSlideshowActions','ReactComposerSlideshowPlacement','CarouselPagesComposerSource','ComposerTargetData','FileInput.react','Grid.react','LayerHideOnBlur','Link.react','ReactComponentWithPureRenderMixin','React','TooltipLink.react','XUIContextualDialog.react','XUIContextualDialogBody.react','joinClasses'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('Grid.react').GridItem,k=c('React').PropTypes,l=c('React').createClass({displayName:'ReactComposerPhotoTaggerButtonWithOptions',mixins:[c('ReactComposerContextMixin'),c('ReactComponentWithPureRenderMixin')],propTypes:{mediaAcceptParam:k.shape({photos:k.string,both:k.string}).isRequired,disableFaceRecognition:k.bool.isRequired,onClick:k.func,photoLimit:k.number.isRequired,targetData:k.instanceOf(c('ComposerTargetData')).isRequired,hasData:k.bool,selected:k.bool,uploadSize:k.number},getDefaultProps:function(){return {hasData:false,mediaAcceptParam:{},selected:false};},getInitialState:function(){return {dialogShown:false};},onLinkClick:function(){this.setState({dialogShown:!this.state.dialogShown});},onToggle:function(m){if(m!==this.state.dialogShown)this.setState({dialogShown:m});},render:function(){if(this.props.uploadSize)return (c('React').createElement(c('ReactComposerMediaFilePickerController.react'),this.props,c('React').createElement(c('ReactComposerPhotoTaggerButton.react'),this.props)));var m=c('joinClasses')((!this.context.gks.has_facelift_glyphs?"_3xen":'')+(this.context.gks.has_facelift_glyphs?' '+"_2vwi":'')+(!this.context.gks.has_facelift_glyphs?' '+"_6xd":'')+(this.context.gks.has_facelift_glyphs?' '+"_lnh":'')+(this.props.hasData?' '+"_6xe":'')+(this.state.dialogShown?' '+"_50hx":''),this.props.className),n=this.props.photoLimit>1?i._("Add photos to your post"):i._("Add a photo to your post"),o=i._("Create a Photo Carousel"),p=i._("Upload Photos\/Video"),q=i._("Create a Slideshow"),r=c('React').createElement(c('XUIContextualDialog.react'),{autoFocus:false,behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')},contextRef:function(){return this.refs.cameraIcon;}.bind(this),offsetY:10,onToggle:this.onToggle,position:'above',shown:this.state.dialogShown,width:c('XUIContextualDialog.react').WIDTH.SMALL},c('React').createElement(c('XUIContextualDialogBody.react'),null,c('React').createElement(c('Grid.react'),{cols:1,spacing:"_2phz"},c('React').createElement(j,null,c('React').createElement(c('Link.react'),{className:"_3fpv",onClick:this._onSlideshowCreationClicked},q)),c('React').createElement(j,null,c('React').createElement(c('Link.react'),{className:"_3fpv",onClick:this._onCarouselCreationClicked},o)),c('React').createElement(j,null,c('React').createElement(c('ReactComposerMediaFilePickerController.react'),this.props,c('React').createElement(c('Link.react'),{className:"_3fpv",onClick:this._onSelect},p))))));return (c('React').createElement('div',{className:"_3xem _3xen",ref:'cameraIcon'},c('React').createElement(c('TooltipLink.react'),{className:m,onClick:this.onLinkClick,tooltip:n},c('React').createElement('span',{className:"accessible_elem"},this.props.photoLimit>1?i._("Add photos"):i._("Add photo"))),r));},_onFilesSelected:function(event){this.props.onFilesSelected(event,this.refs.fileInput.getFileInput());c('ReactComposerMediaUtils').clearInput(this.refs.fileInput.getFileInput());},_onCarouselCreationClicked:function(event){c('ReactComposerAttachmentActions').selectAttachment(this.context.composerID,c('ReactComposerAttachmentType').MEDIA,true);c('ReactComposerPhotoCarouselActions').showPhotoCarouselUrlEditArea(this.context.composerID,c('CarouselPagesComposerSource').CAROUSEL_CAMERA_ICON,this.context.targetID);},_onSlideshowCreationClicked:function(event){c('ReactComposerAttachmentActions').selectAttachment(this.context.composerID,c('ReactComposerAttachmentType').MEDIA,true);c('ReactComposerSlideshowActions').showSlideshowDialog(this.context.composerID,0,c('ReactComposerSlideshowPlacement').CAMERA_ICON_STATUS);}});f.exports=l;},null);